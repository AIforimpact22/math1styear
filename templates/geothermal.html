{# geothermal.html #}
{% extends "index.html" %}

{% block page_title %}{{ t.page_title }}{% endblock %}

{% block controls %}
<div class="controls" aria-label="Page shortcuts">
  <a class="btn" href="{{ url_with_lang('function_examples.function_examples_index') if url_with_lang else '/function-examples?lang=' ~ lang }}">
    {{ t.back_functions }}
  </a>
  <a class="btn" href="{{ url_with_lang('relations.relations_page') if url_with_lang else '/relations?lang=' ~ lang }}">
    {{ t.relations }}
  </a>

  <span class="btn" style="margin-left:auto;">
    {{ t.language }}:
    {% if lang == 'hu' %}
      <a class="btn" href="{{ lang_links.en }}">EN</a>
      <strong>HU</strong>
    {% else %}
      <strong>EN</strong>
      <a class="btn" href="{{ lang_links.hu }}">HU</a>
    {% endif %}
  </span>
</div>
{% endblock %}

{% block content %}
<section class="canvas-card" aria-label="{{ t.section_plot_aria }}">
  <div class="geo-plot">
    <figure>
      <img
        src="{{ url_for('geothermal.plot_png', T0=T0, G=G, zmax=zmax, lang=lang, v=ts) }}"
        alt="{{ t.fig_alt }}"
      >
      <figcaption>
        {{ t.fig_caption.format(zmax=(zmax|round(3))) }}
      </figcaption>
    </figure>
  </div>
</section>

<aside>
  <style>
    .geo-plot{ padding:16px; }
    .geo-plot figure{ margin:0; }
    .geo-plot img{ width:100%; height:auto; display:block; border-radius:12px; border:1px solid #233040; background:#0f141c; }
    .geo-plot figcaption{ margin-top:8px; font-size:13px; color:#a9b8cc; }

    .geo-panel{ display:grid; gap:12px; }
    .geo-panel section{ background:#0f141c; border:1px solid #233040; border-radius:12px; padding:12px; }
    .geo-panel h2{ margin:0 0 8px; font-size:14px; color:#cbd7ea; }

    .geo-form{ display:grid; gap:10px; }
    .geo-form label{ display:flex; flex-direction:column; gap:4px; font-size:13px; color:#cbd7ea; }
    .geo-form input{
      background:#0d1320;
      border:1px solid #263243;
      color:#e8f0ff;
      border-radius:8px;
      padding:8px 10px;
    }
    .geo-form button{ align-self:start; }

    .geo-result{
      display:grid;
      gap:6px;
      background:#0d1320;
      border:1px solid #263243;
      border-radius:10px;
      padding:10px;
      color:#d7e6ff;
    }
    .geo-result strong{ color:#fef9c3; }

    .geo-note{ font-size:12px; color:#9fb2c7; line-height:1.5; }
  </style>

  <div class="geo-panel">
    <section>
      <h2>{{ t.inputs }}</h2>
      <form class="geo-form" method="get">
        <input type="hidden" name="lang" value="{{ lang }}">
        <label>{{ t.label_T0 }}
          <input type="number" step="any" name="T0" value="{{ T0 }}">
        </label>
        <label>{{ t.label_G }}
          <input type="number" step="any" name="G" value="{{ G }}">
        </label>
        <label>{{ t.label_zmax|safe }}
          <input type="number" step="any" min="0" name="zmax" value="{{ zmax }}">
        </label>
        <label>{{ t.label_z }}
          <input type="number" step="any" min="0" name="z" value="{{ zpoint }}">
        </label>
        <label>{{ t.label_T }}
          <input type="number" step="any" name="T" value="{{ Ttarget }}">
        </label>
        <button type="submit" class="btn">{{ t.update_btn }}</button>
      </form>
    </section>

    <section>
      <h2>{{ t.results }}</h2>
      <div class="geo-result">
        <div><strong>{{ t.forward }}</strong>
          {{ t.forward_text.format(z=(zpoint|round(3)), T=(T_at_z|round(3))) }}
        </div>
        <div>
          <strong>{{ t.inverse }}</strong>
          {% if z_for_T is not none %}
            {{ t.inverse_ok.format(T=(Ttarget|round(3)), z=(z_for_T|round(3))) }}
          {% else %}
            {{ t.inverse_fail }}
          {% endif %}
        </div>
      </div>
      <p class="geo-note">
        {{ t.note }}
      </p>
    </section>
  </div>
</aside>

<section class="explain-card" aria-label="How to interpret the geothermal gradient function">
  <div class="explain-head">
    <span class="badge">{{ t.tip_badge }}</span>
    <code>{{ t.tip_code }}</code>
  </div>
  <div class="explain-body">
    {{ t.tip_text }}
  </div>
</section>
{% endblock %}
